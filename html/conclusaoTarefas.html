<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minha Horta - Guia de Plantio</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .transition-garden {
            transition: all 0.3s ease;
        }

        .shadow-garden {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .text-garden-secondary {
            color: #2f4f4f;
        }

        .bg-garden-success {
            background-color: #10b981;
        }

        .text-garden-success {
            color: #10b981;
        }

        .border-garden-primary-light {
            border-color: rgba(100, 116, 139, 0.2);
        }

        .text-muted-foreground {
            color: #6b7280;
        }

        .bg-garden-primary {
            background-color: #10b981;
        }

        .bg-garden-primary-light {
            background-color: rgba(16, 185, 129, 0.1);
        }

        .step-card {
            background: white;
            border-radius: 12px;
            border: 2px solid rgba(100, 116, 139, 0.1);
            padding: 1.5rem;
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .step-card.completed {
            border-color: #10b981;
            background-color: rgba(16, 185, 129, 0.05);
        }

        .step-card.locked {
            opacity: 0.6;
            pointer-events: none;
        }

        .step-number {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background-color: #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 1rem;
        }

        .step-card.completed .step-number {
            background-color: #10b981;
            color: white;
        }

        .progress-bar {
            height: 8px;
            background-color: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            margin: 2rem 0;
        }

        .progress-fill {
            height: 100%;
            background-color: #10b981;
            width: 0%;
            transition: width 0.5s ease;
        }

        .checkmark {
            width: 24px;
            height: 24px;
            border: 2px solid #d1d5db;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .checkmark.checked {
            background-color: #10b981;
            border-color: #10b981;
            color: white;
        }

        .material-icon {
            font-size: 1.25rem;
            margin-right: 0.5rem;
        }
    </style>
</head>

<body class="bg-green-50 min-h-screen flex flex-col items-center p-6">
    <div class="max-w-4xl w-full">
        <header class="mb-8 text-center">
            <div class="flex items-center justify-center gap-3 mb-4">
                <span class="text-4xl">üå±</span>
                <h1 class="text-4xl font-bold text-garden-secondary">Guia de Plantio</h1>
            </div>
            <div id="plant-info" class="bg-white rounded-lg p-6 shadow-garden">
                <h2 class="text-2xl font-bold text-garden-secondary mb-2" id="plant-name">Carregando...</h2>
                <p class="text-muted-foreground" id="plant-description"></p>
            </div>
        </header>

        <div class="progress-bar">
            <div class="progress-fill" id="progress-fill"></div>
        </div>

        <div id="steps-container" class="space-y-4">
            <!-- Passos ser√£o inseridos dinamicamente -->
        </div>

        <div class="text-center mt-12">
            <button id="finish-planting"
                class="bg-garden-primary text-white font-semibold py-3 px-8 rounded-lg hover:bg-garden-success/80 transition-garden text-lg disabled:opacity-50 disabled:cursor-not-allowed"
                disabled>
                üåü Finalizar Plantio
            </button>
            <a href="escolher-plantas.html" class="ml-4 text-garden-secondary hover:underline">‚Üê Voltar</a>
        </div>

        <footer class="mt-12 text-center text-muted-foreground">
            ¬© 2024 Minha Horta. Todos os direitos reservados.
        </footer>
    </div>

    <script>
        // Base de dados de guias de plantio
        const plantingGuides = {
            // VERDURAS
            'alface': {
                nome: 'Alface',
                descricao: 'Folha verde f√°cil de cultivar, ideal para saladas frescas.',
                passos: [
                    {
                        titulo: 'Prepara√ß√£o do Solo',
                        descricao: 'Prepare um solo bem drenado e rico em mat√©ria org√¢nica. Misture terra vegetal com composto org√¢nico.',
                        duracao: '30 minutos',
                        materiais: ['Vaso ou canteiro', 'Terra vegetal', 'Comp√≥sito org√¢nico', 'P√° pequena']
                    },
                    {
                        titulo: 'Plantio das Sementes',
                        descricao: 'Fa√ßa pequenas covas de 0,5cm de profundidade, coloque 2-3 sementes em cada e cubra levemente com terra.',
                        duracao: '20 minutos',
                        materiais: ['Sementes de alface', 'Regador']
                    },
                    {
                        titulo: 'Rega Inicial',
                        descricao: 'Regue suavemente para umedecer o solo sem encharcar. Mantenha o solo √∫mido nos primeiros dias.',
                        duracao: '10 minutos',
                        materiais: ['Regador com √°gua']
                    },

                ]
            },
            'rucula': {
                nome: 'R√∫cula',
                descricao: 'Folhagem picante e nutritiva, perfeita para saladas.',
                passos: [
                    {
                        titulo: 'Prepara√ß√£o do Solo',
                        descricao: 'Use solo leve e bem drenado. A r√∫cula prefere solos com pH neutro.',
                        duracao: '25 minutos',
                        materiais: ['Vaso ou canteiro', 'Terra vegetal', 'Areia para drenagem']
                    },
                    {
                        titulo: 'Plantio das Sementes',
                        descricao: 'Espalhe as sementes uniformemente e cubra com fina camada de terra. N√£o enterre profundamente.',
                        duracao: '15 minutos',
                        materiais: ['Sementes de r√∫cula', 'Regador']
                    },
                    {
                        titulo: 'Rega Inicial',
                        descricao: 'Regue com cuidado para n√£o deslocar as sementes. Solo deve ficar √∫mido mas n√£o encharcado.',
                        duracao: '10 minutos',
                        materiais: ['Regador com √°gua']
                    },

                ]
            },
            'couve': {
                nome: 'Couve',
                descricao: 'Folhagem verde e robusta, muito vers√°til na cozinha.',
                passos: [
                    {
                        titulo: 'Prepara√ß√£o do Solo',
                        descricao: 'Solo profundo e rico em nutrientes. Adicione bastante composto org√¢nico.',
                        duracao: '35 minutos',
                        materiais: ['Vaso grande ou canteiro', 'Terra vegetal', 'Comp√≥sito org√¢nico', 'P√°']
                    },
                    {
                        titulo: 'Plantio das Mudas',
                        descricao: 'Plante mudas com espa√ßamento de 50cm entre elas. Enterre at√© a base das primeiras folhas.',
                        duracao: '30 minutos',
                        materiais: ['Mudas de couve', 'Regador']
                    },
                    {
                        titulo: 'Rega Inicial',
                        descricao: 'Regue abundantemente ap√≥s o plantio. A couve precisa de solo sempre √∫mido.',
                        duracao: '15 minutos',
                        materiais: ['Regador com √°gua']
                    },

                ]
            },
            // TEMPEROS
            'manjericao': {
                nome: 'Manjeric√£o',
                descricao: 'Erva arom√°tica perfeita para molhos e temperos.',
                passos: [
                    {
                        titulo: 'Prepara√ß√£o do Solo',
                        descricao: 'Solo leve, bem drenado e rico em mat√©ria org√¢nica. pH entre 6.0 e 7.5.',
                        duracao: '25 minutos',
                        materiais: ['Vaso com furos', 'Terra vegetal', 'Areia', 'Comp√≥sito']
                    },
                    {
                        titulo: 'Plantio das Sementes/Mudas',
                        descricao: 'Plante sementes superficiais ou mudas com espa√ßamento de 20cm. N√£o enterre profundamente.',
                        duracao: '20 minutos',
                        materiais: ['Sementes ou mudas de manjeric√£o', 'Regador']
                    },
                    {
                        titulo: 'Rega Inicial',
                        descricao: 'Regue moderadamente. Manjeric√£o n√£o gosta de solo encharcado.',
                        duracao: '10 minutos',
                        materiais: ['Regador com √°gua']
                    },

                ]
            },
            'salsa': {
                nome: 'Salsa',
                descricao: 'Erva arom√°tica vers√°til para diversos pratos.',
                passos: [
                    {
                        titulo: 'Prepara√ß√£o do Solo',
                        descricao: 'Solo f√©rtil, bem drenado e rico em mat√©ria org√¢nica. pH neutro a levemente alcalino.',
                        duracao: '20 minutos',
                        materiais: ['Vaso ou canteiro', 'Terra vegetal', 'Comp√≥sito org√¢nico']
                    },
                    {
                        titulo: 'Plantio das Sementes',
                        descricao: 'Semeie superficialmente e cubra com fina camada de terra. A salsa tem germina√ß√£o lenta.',
                        duracao: '15 minutos',
                        materiais: ['Sementes de salsa', 'Regador']
                    },
                    {
                        titulo: 'Rega Inicial',
                        descricao: 'Mantenha o solo constantemente √∫mido durante a germina√ß√£o.',
                        duracao: '10 minutos',
                        materiais: ['Regador com √°gua']
                    },

                ]
            },
            'cebolinha': {
                nome: 'Cebolinha',
                descricao: 'Tempero vers√°til para saladas, sopas e omeletes.',
                passos: [
                    {
                        titulo: 'Prepara√ß√£o do Solo',
                        descricao: 'Solo bem drenado e rico em mat√©ria org√¢nica. Pode ser plantada em vasos pequenos.',
                        duracao: '20 minutos',
                        materiais: ['Vaso pequeno', 'Terra vegetal', 'Comp√≥sito']
                    },
                    {
                        titulo: 'Plantio das Mudas/Sementes',
                        descricao: 'Plante mudas divididas ou sementes com espa√ßamento de 10cm.',
                        duracao: '15 minutos',
                        materiais: ['Mudas ou sementes de cebolinha', 'Regador']
                    },
                    {
                        titulo: 'Rega Inicial',
                        descricao: 'Regue bem ap√≥s o plantio e mantenha o solo √∫mido.',
                        duracao: '10 minutos',
                        materiais: ['Regador com √°gua']
                    },

                ]
            },
            'alecrim': {
                nome: 'Alecrim',
                descricao: 'Arbusto arom√°tico resistente para carnes e assados.',
                passos: [
                    {
                        titulo: 'Prepara√ß√£o do Solo',
                        descricao: 'Solo bem drenado, preferencialmente arenoso. N√£o precisa de muita mat√©ria org√¢nica.',
                        duracao: '20 minutos',
                        materiais: ['Vaso com boa drenagem', 'Terra arenosa', 'Areia']
                    },
                    {
                        titulo: 'Plantio das Mudas',
                        descricao: 'Plante mudas com espa√ßamento de 30cm. Alecrim prefere n√£o ser transplantado.',
                        duracao: '25 minutos',
                        materiais: ['Mudas de alecrim', 'Regador']
                    },
                    {
                        titulo: 'Rega Inicial',
                        descricao: 'Regue moderadamente ap√≥s o plantio. Alecrim tolera solo seco.',
                        duracao: '10 minutos',
                        materiais: ['Regador com √°gua']
                    },

                ]
            }
        };

        let currentPlant = '';
        let completedSteps = 0;
        let totalSteps = 0;

        function loadPlantingGuide() {
            // Obt√©m a planta selecionada da URL
            const urlParams = new URLSearchParams(window.location.search);
            const plantId = urlParams.get('plant');

            if (!plantId || !plantingGuides[plantId]) {
                document.getElementById('plant-name').textContent = 'Planta n√£o encontrada';
                document.getElementById('plant-description').textContent = 'Volte e selecione uma planta v√°lida.';
                return;
            }

            currentPlant = plantId;
            const guide = plantingGuides[plantId];

            // Atualiza informa√ß√µes da planta
            document.getElementById('plant-name').textContent = guide.nome;
            document.getElementById('plant-description').textContent = guide.descricao;

            // Renderiza os passos
            totalSteps = guide.passos.length;
            renderSteps(guide.passos);

            // Atualiza progresso
            updateProgress();
        }

        function renderSteps(passos) {
            const container = document.getElementById('steps-container');
            container.innerHTML = '';

            passos.forEach((passo, index) => {
                const stepNumber = index + 1;
                const isLocked = index > 0; // Primeiro passo sempre liberado

                const stepHTML = `
                    <div class="step-card ${isLocked ? 'locked' : ''}" id="step-${stepNumber}">
                        <div class="flex items-start">
                            <div class="step-number">${stepNumber}</div>
                            <div class="flex-1">
                                <div class="flex items-center justify-between mb-3">
                                    <h3 class="text-xl font-semibold text-garden-secondary">${passo.titulo}</h3>
                                    <div class="checkmark" data-step="${stepNumber}">
                                        ${!isLocked ? '‚úì' : ''}
                                    </div>
                                </div>
                                <p class="text-muted-foreground mb-4">${passo.descricao}</p>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                                    <div>
                                        <strong class="text-garden-secondary">‚è±Ô∏è Dura√ß√£o:</strong>
                                        <span class="text-muted-foreground ml-2">${passo.duracao}</span>
                                    </div>
                                    <div>
                                        <strong class="text-garden-secondary">üõ†Ô∏è Materiais Necess√°rios:</strong>
                                        <div class="text-muted-foreground mt-1">
                                            ${passo.materiais.map(material =>
                    `<div class="flex items-center mb-1">
                                                    <span class="material-icon">üìå</span>
                                                    <span>${material}</span>
                                                </div>`
                ).join('')}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                container.innerHTML += stepHTML;
            });

            // Adiciona event listeners aos checkmarks
            document.querySelectorAll('.checkmark').forEach(checkmark => {
                if (!checkmark.closest('.step-card.locked')) {
                    checkmark.addEventListener('click', function () {
                        const stepNumber = parseInt(this.getAttribute('data-step'));
                        toggleStepCompletion(stepNumber);
                    });
                }
            });
        }

        function toggleStepCompletion(stepNumber) {
            const stepCard = document.getElementById(`step-${stepNumber}`);
            const checkmark = stepCard.querySelector('.checkmark');

            if (checkmark.classList.contains('checked')) {
                // Desmarcar
                checkmark.classList.remove('checked');
                stepCard.classList.remove('completed');
                completedSteps--;
            } else {
                // Marcar
                checkmark.classList.add('checked');
                stepCard.classList.add('completed');
                completedSteps++;

                // Liberar pr√≥ximo passo
                if (stepNumber < totalSteps) {
                    const nextStepCard = document.getElementById(`step-${stepNumber + 1}`);
                    nextStepCard.classList.remove('locked');
                    nextStepCard.querySelector('.checkmark').innerHTML = '‚úì';

                    // Adiciona event listener ao pr√≥ximo passo
                    nextStepCard.querySelector('.checkmark').addEventListener('click', function () {
                        toggleStepCompletion(stepNumber + 1);
                    });
                }
            }

            updateProgress();
        }

        function updateProgress() {
            const progress = (completedSteps / totalSteps) * 100;
            document.getElementById('progress-fill').style.width = `${progress}%`;

            // Habilita bot√£o final se todos os passos estiverem completos
            const finishButton = document.getElementById('finish-planting');
            finishButton.disabled = completedSteps !== totalSteps;
        }
        function gerarTarefasIniciais(tipo) {
            const tarefas = {
                alface: ['Regar hoje', 'Verificar solo'],
                rucula: ['Regar a cada 2 dias', 'Podar folhas velhas'],
                couve: ['Regar abundantemente', 'Verificar pragas'],
                manjericao: ['Regar diariamente', 'Podar flores'],
                salsa: ['Regar a cada 2 dias', 'Colher ramos externos'],
                cebolinha: ['Regar regularmente', 'Cortar folhas'],
                alecrim: ['Regar a cada 4 dias', 'Podar para crescimento'],
                default: ['Regar planta', 'Verificar luz solar']
            };
            return tarefas[tipo] || tarefas.default;
        }

        function finishPlanting() {
            if (completedSteps !== totalSteps) {
                alert('Complete todos os passos antes de finalizar!');
                return;
            }

            const guide = plantingGuides[currentPlant];

            // === CRIA A PLANTA NO localStorage ===
            // const novaPlanta = {
            //     id: `plant-${Date.now()}`,
            //     tipo: currentPlant,
            //     nome: guide.nome,
            //     imagem: `img/${currentPlant}.jfif`,  // ajusta conforme seu padr√£o
            //     dataPlantio: new Date().toISOString(),
            //     progresso: 0,
            //     saudavel: true,
            //     metodo: 'vasos',  // voc√™ pode adicionar escolha depois
            //     tarefasPendentes: gerarTarefasIniciais(currentPlant)
            // };

            // // Salva no localStorage
            // let userPlants = [];
            // const saved = localStorage.getItem('hortaPlants');
            // if (saved) userPlants = JSON.parse(saved);
            // userPlants.push(novaPlanta);
            // localStorage.setItem('hortaPlants', JSON.stringify(userPlants));

            // // Salva usu√°rio (se n√£o existir)
            // if (!localStorage.getItem('hortaUser')) {
            //     const userName = prompt('Qual √© o seu nome?') || 'Hortel√£o';
            //     localStorage.setItem('hortaUser', JSON.stringify({ nome: userName }));
            // }

            alert(`Parab√©ns! Voc√™ plantou ${guide.nome}!`);

            // === VAI PARA O DASHBOARD ===
            window.location.href = 'plantacao.html';
        }

        function enviarParaDashboard(data) {
            // simula o envio dos dados para a dashboard via API
            fetch('/api/plantio-concluido', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            })
                .then(response => response.json())
                .then(data => {
                    console.log('Plantio registrado:', data);

                })
                .catch((error) => {
                    console.error('Erro:', error);
                });
        }



        // Event listeners
        document.getElementById('finish-planting').addEventListener('click', finishPlanting);

        // Carrega o guia quando a p√°gina √© carregada
        document.addEventListener('DOMContentLoaded', loadPlantingGuide);
    </script>
</body>

</html>